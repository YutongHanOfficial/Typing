<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monkeytype Clone</title>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* --- Global Styles --- */
  body {
    margin:0;
    font-family: 'Fira Code', monospace;
    background:#0f111a;
    color:#f0f0f0;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-start;
    min-height:100vh;
    padding:2rem;
  }
  h1 { font-size:2.5rem; margin-bottom:1rem; }
  button, select {
    padding:0.5rem 1rem;
    margin:0.5rem;
    border:none;
    border-radius:5px;
    background:#1a1c29;
    color:#f0f0f0;
    cursor:pointer;
    font-size:1rem;
    transition: background 0.2s;
  }
  button:hover, select:hover { background:#2a2d40; }
  .mode-container { margin-bottom:1rem; display:flex; flex-wrap:wrap; gap:0.5rem; justify-content:center; }
  #timer { font-size:1.5rem; margin:1rem 0; }
  .word-container {
    display:flex;
    flex-wrap:wrap;
    max-width:900px;
    gap:0.5rem;
    padding:1rem;
    background:#1a1c29;
    border-radius:8px;
    min-height:120px;
  }
  .word { padding:0.2rem 0.4rem; border-radius:4px; }
  .current { text-decoration:underline; }
  .correct { color:#4ade80; }
  .wrong { color:#f87171; }
  #typing-input {
    width:400px;
    padding:0.5rem;
    border-radius:5px;
    border:none;
    outline:none;
    background:#12141f;
    color:#f0f0f0;
    font-size:1rem;
  }
  .end-screen { text-align:center; margin-top:2rem; }
  .stats { margin-top:1rem; background:#1a1c29; padding:1rem; border-radius:8px; max-width:400px; }
</style>
</head>
<body>

<h1>Monkeytype Clone</h1>

<div class="mode-container">
  <select id="mode-select">
    <option value="time-15">15 Seconds</option>
    <option value="time-30">30 Seconds</option>
    <option value="time-60">60 Seconds</option>
    <option value="words-10">10 Words</option>
    <option value="words-25">25 Words</option>
    <option value="words-100">100 Words</option>
  </select>
  <button id="start-btn">Start Test</button>
  <button id="view-stats">View Stats</button>
</div>

<div id="timer"></div>
<div class="word-container" id="word-container"></div>
<input type="text" id="typing-input" autocomplete="off" disabled>

<div class="end-screen" id="end-screen" style="display:none;"></div>

<script>
// --- Wordlist (shortened 1k words) ---
const WORDS = ["the","be","and","of","a","in","to","have","it","I","that","for","you","he","with","on","do","say","this","they","at","but","we","his","from","not","by","she","or","as","what","go","their","can","who","get","if","would","her","all","my","make","about","know","will","up","one","time","there","year","so","think","when","which","them","some","me","people","take","out","into","just","see","him","your","come","could","now","than","like","other","how","then","its","our","two","more","these","want","way","look","first","also","new","because","day","more","use","no","man","find","here","thing","give","many","well"];

// --- Elements ---
const wordContainer = document.getElementById("word-container");
const input = document.getElementById("typing-input");
const timerEl = document.getElementById("timer");
const startBtn = document.getElementById("start-btn");
const modeSelect = document.getElementById("mode-select");
const endScreen = document.getElementById("end-screen");
const viewStatsBtn = document.getElementById("view-stats");

// --- Variables ---
let words=[],currentIndex=0,errors=0,correctChars=0,timer=0,interval=null;
let modeType="time",modeValue=15;

// --- Functions ---
function shuffleWords(count){
  const arr=[];
  for(let i=0;i<count;i++) arr.push(WORDS[Math.floor(Math.random()*WORDS.length)]);
  return arr;
}
function renderWords(){
  wordContainer.innerHTML="";
  words.forEach((word,i)=>{
    const span=document.createElement("span");
    span.textContent=word;
    span.className="word";
    if(i===currentIndex) span.classList.add("current");
    // highlight typed letters
    if(i<currentIndex){
      span.classList.add("correct");
    }
    wordContainer.appendChild(span);
  });
}
function startTest(){
  const [type,value] = modeSelect.value.split("-");
  modeType=type; modeValue=Number(value);
  currentIndex=0; errors=0; correctChars=0;
  endScreen.style.display="none"; input.disabled=false; input.value=""; input.focus();

  const wordCount = modeType==="words"?modeValue:200;
  words=shuffleWords(wordCount);
  renderWords();

  if(modeType==="time"){
    timer=modeValue;
    timerEl.textContent=`${timer}s`;
    interval=setInterval(()=>{
      timer--; timerEl.textContent=`${timer}s`;
      if(timer<=0){ clearInterval(interval); finishTest(); }
    },1000);
  } else { timerEl.textContent=""; }
}

function finishTest(){
  input.disabled=true;
  const totalChars=words.slice(0,modeType==="words"?modeValue:words.length).join(" ").length;
  const wpm=Math.round((correctChars/5)/(modeType==="time"?modeValue/60:1));
  const accuracy=Math.round((correctChars/(correctChars+errors*5))*100);
  // Save stats
  const key=modeSelect.value;
  const stats=JSON.parse(localStorage.getItem("typingStats")||"{}");
  if(!stats[key] || wpm>stats[key].wpm){ stats[key]={wpm,accuracy}; localStorage.setItem("typingStats",JSON.stringify(stats)); }
  endScreen.innerHTML=`<h2>Test Finished!</h2>
    <p>WPM: ${wpm}</p><p>Accuracy: ${accuracy}%</p>
    <button onclick="startTest()">Retry</button>`;
  endScreen.style.display="block";
}

// --- Input handler ---
input.addEventListener("keydown",(e)=>{
  if(e.key===" "||e.key==="Enter"){
    e.preventDefault();
    const typed=input.value.trim();
    const current=words[currentIndex];
    if(typed!==current) errors++;
    else correctChars+=current.length;
    currentIndex++;
    if(modeType==="words"&&currentIndex>=modeValue){ finishTest(); }
    else if(currentIndex>=words.length){ finishTest(); }
    else { renderWords(); input.value=""; }
  }
});

// --- Stats viewer ---
viewStatsBtn.addEventListener("click",()=>{
  const stats=JSON.parse(localStorage.getItem("typingStats")||"{}");
  let html="<div class='stats'><h3>Personal Bests</h3>";
  if(Object.keys(stats).length===0) html+="<p>No stats yet.</p>";
  else html+="<ul>"+Object.entries(stats).map(([k,v])=>`<li>${k}: WPM ${v.wpm}, Accuracy ${v.accuracy}%</li>`).join("")+"</ul>";
  html+="<button onclick='endScreen.style.display=\"none\"'>Close</button></div>";
  endScreen.innerHTML=html; endScreen.style.display="block";
});

// --- Start button ---
startBtn.addEventListener("click",startTest);
</script>
</body>
</html>
